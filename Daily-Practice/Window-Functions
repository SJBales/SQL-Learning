-- Day 1. Concepts explored: RANK, DENSE_RANK, ROW_NUMBER

-- Practicing using ROW_NUMBER
SELECT case_number,
       block,
       primary_type,
       EXTRACT(MONTH FROM date) AS month,
       ROW_NUMBER()
        OVER(PARTITION BY primary_type, block
             ORDER BY EXTRACT(MONTH FROM date)) AS event_number
FROM `bigquery-public-data.chicago_crime.crime`
LIMIT 100;

-- Day 2. Concepts explored: LAG and LEAD

SELECT case_number,
       block,
       primary_type,
       EXTRACT(MONTH FROM date) AS month,
       LAG(case_number, 1)
        OVER(PARTITION BY primary_type, block
             ORDER BY date) AS event_number
FROM `bigquery-public-data.chicago_crime.crime`
LIMIT 100;

-- Day 3. Working with the frame clause (ROWS and RANGE)

-- Practice Query
SELECT
  job_id,
  employee_id,
  first_name,
  last_name,
  hire_date,
  COUNT(employee_id) OVER (
    PARTITION BY
      job_id
    ORDER BY
      hire_date 
  ROWS BETWEEN 1 PRECEDING AND CURRENT ROW
  ) AS hire_order
FROM
  employees;
